spring:
  application:
    name: jpa-oracle-source

  # Prevent Spring Cloud Config import-check failures
  cloud:
    config:
      enabled: false
      import-check:
        enabled: false

    function:
      definition: oracleToSolace

    stream:
      # Make binder resolution unambiguous
      defaultBinder: solace

      binders:
        solace:
          type: solace
          environment:
            solace:
              java:
                host: ${SOLACE_HOST}
                msgVpn: ${SOLACE_VPN}
                clientUsername: ${SOLACE_USERNAME}
                clientPassword: ${SOLACE_PASSWORD}

      bindings:
        # SOURCE connector publishes only (no -in-0 binding)
        oracleToSolace-out-0:
          binder: solace
          destination: db/oracle/test_identification

# Database settings for the source connector
solace-persistence:
  datasource:
    driver-class-name: oracle.jdbc.OracleDriver
    url: ${ORACLE_JDBC_URL}
    username: ${ORACLE_USERNAME}
    password: ${ORACLE_PASSWORD}
    hikari:
      initializationFailTimeout: -1
      connection-timeout: 5000

  source:
    dbQueryMode: jpa
    # polling / batching tuning (safe defaults)
    sendBatchSize: 1
    queryMax: 100
    triggerInterval: 2000

# âœ… IMPORTANT: workflows must live HERE (this is what the connector binds)
solace:
  connector:
    workflows:
      - name: test_identification
        enabled: true
        source:
          type: database
          databaseRef: source
          table: TEST_IDENTIFICATION
          polling:
            intervalMs: 1000
        target:
          type: solace
          destinationType: topic
          topic: db/oracle/test_identification

      - name: test_metrics
        enabled: true
        source:
          type: database
          databaseRef: source
          table: TEST_METRICS
          polling:
            intervalMs: 1000
        target:
          type: solace
          destinationType: topic
          topic: db/oracle/test_metrics

management:
  observations:
    enabled: false
  tracing:
    enabled: false
  datadog:
    metrics:
      export:
        enabled: false
